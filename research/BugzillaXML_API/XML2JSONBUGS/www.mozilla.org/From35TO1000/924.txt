{"bugs":[{"creation_time":"Mon Sep 28 18:46:27 EEST 1998","keywords":["crash","regression"],"see_also":[],"resolution":"FIXED","cf_blocking_fx":"---","cf_fx_iteration":"---","cf_blocking_b2g":"---","cf_status_b2g_1_4":"---","id":924,"is_open":false,"cf_qa_whiteboard":"","assigned_to_detail":{"name":"pnunn@formerly-netscape.com.tld","real_name":"","id":1681,"email":"pnunn@formerly-netscape.com.tld"},"creator_detail":{"name":"michael.j.lowe@gmail.com","real_name":"Michael Lowe","id":2365,"email":"michael.j.lowe@gmail.com"},"cf_status_firefox37":"---","priority":"P1","cf_status_firefox36":"---","classification":"Components","cf_status_firefox35":"---","version":"Trunk","cf_status_firefox34":"---","op_sys":"Linux","last_change_time":"Tue May 02 23:11:48 EEST 2000","cf_crash_signature":"","mentors_detail":[],"cf_tracking_b2g":"---","qa_contact_detail":{"name":"elig@formerly-netscape.com.tld","real_name":"Eli Goldberg","id":1698,"email":"elig@formerly-netscape.com.tld"},"cf_status_b2g_2_0m":"---","status":"VERIFIED","cf_feature_b2g":"---","is_cc_accessible":true,"cf_tracking_firefox37":"---","cf_tracking_firefox36":"---","cf_tracking_relnote_b2g":"---","flags":[],"cf_status_firefox_esr31":"---","whiteboard":"broken again","platform":"x86","cf_tracking_firefox_esr31":"---","cf_blocking_fennec":"---","cf_fx_points":"---","cf_tracking_firefox35":"---","cf_tracking_firefox34":"---","cf_status_b2g_2_2":"---","cf_status_b2g_2_1":"---","cf_status_b2g_2_0":"---","assigned_to":"pnunn@formerly-netscape.com.tld","summary":"Crash after loading PNG test icon suite","cf_tracking_e10s":"---","cc":["newt@pobox.com"],"severity":"critical","creator":"michael.j.lowe@gmail.com","product":"Core","depends_on":[],"cf_tracking_firefox_relnote":"---","blocks":[9336],"is_confirmed":true,"groups":[],"cf_last_resolved":"Fri Apr 28 17:53:24 EEST 2000","url":"http://www.cdrom.com/pub/png/PngSuite/xlfn0g04.png","qa_contact":"elig@formerly-netscape.com.tld","target_milestone":"M16","component":"ImageLib","is_creator_accessible":true,"cc_detail":[{"name":"newt@pobox.com","real_name":"Greg Roelofs","id":2910,"email":"newt@pobox.com"}],"mentors":[],"cf_user_story":""}],"comments":[{"is_private":false,"creation_time":"Mon Sep 28 18:46:27 EEST 1998","creator":"michael.j.lowe@gmail.com","author":"michael.j.lowe@gmail.com","time":"Mon Sep 28 18:46:27 EEST 1998","text":"Mozilla crashes while loading the page of PNG test icons located at:  http://www.cdrom.com/pub/png/pngsuite.html","id":3731,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Mon Nov 23 22:23:59 EET 1998","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Mon Nov 23 22:23:59 EET 1998","text":"I am seeing the crash on xlfn0g04.png. but I expect I could see it on xcrn0g04.png. Both have been corrupted. The browser shouldn't crash even if the image has garbage in it.","id":3732,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Tue Nov 24 00:51:59 EET 1998","creator":"michael.j.lowe@gmail.com","author":"michael.j.lowe@gmail.com","time":"Tue Nov 24 00:51:59 EET 1998","text":"Same thing happens in nglayout viewer.exe","id":3733,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Tue Nov 24 18:25:59 EET 1998","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Tue Nov 24 18:25:59 EET 1998","text":"All the viewers use the same image decoding code.","id":3734,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sun Dec 13 03:20:59 EET 1998","creator":"michael.j.lowe@gmail.com","author":"michael.j.lowe@gmail.com","time":"Sun Dec 13 03:20:59 EET 1998","text":"I've managed to track down and fix this bug.   This fix consists of two parts:  1. A replacement file for ipng.cpp in the imglib, available at:   http://www.geocities.com/SiliconValley/Haven/8120/ipng_cpp.txt  2. A patch for the file for nsImageNetContextAsync.cpp in gfx, available at:   http://www.geocities.com/SiliconValley/Haven/8120/img_diff.txt","id":3735,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Wed Feb 03 16:04:59 EET 1999","creator":"leger@formerly-netscape.com.tld","author":"leger@formerly-netscape.com.tld","time":"Wed Feb 03 16:04:59 EET 1999","text":"Setting all current Open Critical and Major to M3","id":3736,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Thu Feb 04 23:16:59 EET 1999","creator":"elig@formerly-netscape.com.tld","author":"elig@formerly-netscape.com.tld","time":"Thu Feb 04 23:16:59 EET 1999","text":"[adding self as QA contact]","id":3737,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Thu Mar 11 23:24:59 EET 1999","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Thu Mar 11 23:24:59 EET 1999","text":"I just tested today's release build on xlfn0g04.png and xcrn0g04.png and gecko doesn't crash. Neither are they displayed (they are corrupted pngs and shouldn't display) but the broken image icon should display and it doesn't.  Not a M3 problem, but M6. -pnunn","id":3738,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sat Apr 03 05:19:59 EEST 1999","creator":"alan-lists@ajsquared.us","author":"alan-lists@ajsquared.us","time":"Sat Apr 03 05:19:59 EEST 1999","text":"I justed tested this problem with the 4/2/99 build and it still crashes on the above url under Windows 95.  My DOS Window (see below) says PNG file corrupted.  ==DOS WINDOW ====================================== FindBookmarkShortcut: in='http://www.cdrom.com/pub/png/pngsuite.html'  out='' URL to load in nsBrowserAppCore is http://www.cdrom.com/pub/png/pngsuite.html nsMessengerNameSet::AddNameSet() Registering Messenger in the JS namespace nsComposerNameSet::AddNameSet() Registering Composer in the JS namespace nsMessengerNameSet::InitializeClasses() Initializing base classes nsComposerNameSet::InitializeClasses() Initializing base classes libpng error: PNG file corrupted by ASCII conversion  ======================================== APPRUNNER caused an invalid page fault in module MSVCRT.DLL at 014f:78001230. Registers: EAX=0086f9f0 CS=014f EIP=78001230 EFLGS=00010246 EBX=00880034 SS=0157 ESP=0076fac8 EBP=0076fae8 ECX=00000002 DS=0157 ESI=ffffffff FS=4daf EDX=04bfc16c ES=0157 EDI=00873a08 GS=0000 Bytes at CS:EIP: 89 79 08 0f 84 07 01 00 00 8b 4d f4 8b 7c f1 04 Stack dump: 000000b4 000000b4 04bd3800 bff798a5 000000c0 008739b0 00000000 0000001f 0076fb44 7800140e 00880034 00000009 000000b4 04bfaa50 780013e9 000000b4","id":3739,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sat Jun 12 00:25:59 EEST 1999","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Sat Jun 12 00:25:59 EEST 1999","text":"asdf","id":3740,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Thu Jul 01 18:46:59 EEST 1999","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Thu Jul 01 18:46:59 EEST 1999","text":"Greg: Would you take a look at this one? It looks like the crash occurs when we try to free up png_ptr->zbuf when its a garbage ptr. The test in the free is for NULL and so it happily continues on its crashing way. The code in png_create_struct() isn't catching the error that occurs when the structure is allocated.  The first image crashing is xlfn0g04.png. there may be more, but this image is the first one. I've changed the URL, so it points to the bad png.","id":3741,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sat Jul 03 18:39:59 EEST 1999","creator":"newt@pobox.com","author":"newt@pobox.com","time":"Sat Jul 03 18:39:59 EEST 1999","text":"Pamela,  The problem is simply that the error handler was never set up before calling png_process_data() in ipng.cpp.  longjmp() gets called and goes off to who knows where, eventually segfaulting.  Here's a short patch that fixes just this one problem (stupid attachment option didn't work and lost my first message, sigh):  *** ipng.cpp.stock      Sat Jul  3 11:04:16 1999 --- ipng.cpp    Sat Jul  3 11:22:14 1999 *************** *** 114,119 **** --- 114,123 ----       }       /* note addition of ic to png structure.... */       png_ptr->io_ptr = ic; +     if (setjmp(png_ptr->jmpbuf)) { +         png_destroy_read_struct(&png_ptr, &info_ptr, NULL); +         return !OK; +     }       png_process_data( png_ptr, info_ptr, (unsigned char *)buf, len );       ipng_ptr->state = PNG_CONTINUE;   Note, however, that I'm rewriting much of the PNG code and should be done with that later today; I'll send you the (large) patch separately.  If you're around today (3 July), send me some e-mail--even with the patch above, il_png_write() gets called a second time, and I haven't yet figured out why.","id":3742,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Tue Jul 06 18:03:59 EEST 1999","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Tue Jul 06 18:03:59 EEST 1999","text":"Thanks Greg. I'll check this is as soon as the tree opens. -pn","id":3743,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Tue Jul 06 22:59:59 EEST 1999","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Tue Jul 06 22:59:59 EEST 1999","text":"*** Bug 9000 has been marked as a duplicate of this bug. ***","id":3744,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Wed Jul 07 19:28:59 EEST 1999","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Wed Jul 07 19:28:59 EEST 1999","text":"fix checked in 07-07-99. -pn","id":3745,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sat Jul 10 05:20:59 EEST 1999","creator":"elig@formerly-netscape.com.tld","author":"elig@formerly-netscape.com.tld","time":"Sat Jul 10 05:20:59 EEST 1999","text":"On Win32, Linux and Mac OS (7.9.99 PM build), a crash no longer takes place; instead, a dot appears where the image file name should appear.  I'm going to investigate this further after M8 is finished, and either re-open or break out a new bug.","id":3746,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Wed Jul 14 00:27:59 EEST 1999","creator":"elig@formerly-netscape.com.tld","author":"elig@formerly-netscape.com.tld","time":"Wed Jul 14 00:27:59 EEST 1999","text":"Verifying as fixed; side-issue broken into 9796.","id":3747,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sun Apr 16 20:58:31 EEST 2000","creator":"newt@pobox.com","author":"newt@pobox.com","time":"Sun Apr 16 20:58:31 EEST 2000","text":"Linux build from 2000-04-14 sourceball is crashing (segfault) on corrupted PNG images again.  The first of these pages has three bad images inlined (including the one given above), while the second only has links to them and doesn't cause a crash:   http://www.cdrom.com/pub/png/pngsuite.html  http://www.cdrom.com/pub/png/pngsuite-all-good.html  It appears that the libpng-related error-handling code in ipng.cpp is working correctly, returning control to il_png_write() via a longjmp().  That function then sets the state to PNG_ERROR and passes an error value to whatever called it.  But apparently something upstream is ignoring the error value once again and subsequently returns control to ipng.cpp, which no longer has a valid PNG (libpng) context.","id":264690,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sun Apr 16 21:01:06 EEST 2000","creator":"newt@pobox.com","author":"newt@pobox.com","time":"Sun Apr 16 21:01:06 EEST 2000","text":"reassigning to owner; leaving priority and severity alone","id":264708,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sun Apr 16 21:27:58 EEST 2000","creator":"newt@pobox.com","author":"newt@pobox.com","time":"Sun Apr 16 21:27:58 EEST 2000","text":"adding regression and crash keywords","id":264763,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Tue Apr 18 17:55:04 EEST 2000","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Tue Apr 18 17:55:04 EEST 2000","text":"have fix. waiting for open tree. -p","id":266656,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Wed Apr 19 01:31:30 EEST 2000","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Wed Apr 19 01:31:30 EEST 2000","text":"checked in. -p","id":267410,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Wed Apr 19 18:22:28 EEST 2000","creator":"elig@formerly-netscape.com.tld","author":"elig@formerly-netscape.com.tld","time":"Wed Apr 19 18:22:28 EEST 2000","text":"Verified fixed (doesn't crash) using this morning's builds on Mac, Win & Linux. ","id":268028,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sat Apr 22 01:52:13 EEST 2000","creator":"newt@pobox.com","author":"newt@pobox.com","time":"Sat Apr 22 01:52:13 EEST 2000","text":"Not fixed.  It doesn't crash immediately upon loading the page, as it did before, but today's \"nightly\" for Linux/glibc segfaults as soon as you scroll down to where the bogus images are inlined.","id":270866,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Sat Apr 22 01:57:36 EEST 2000","creator":"newt@pobox.com","author":"newt@pobox.com","time":"Sat Apr 22 01:57:36 EEST 2000","text":"Oddly enough, no crash occurs on today's Win32 nightly.  But no \"broken image\" icons are displayed, either.","id":270871,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Fri Apr 28 17:53:24 EEST 2000","creator":"pnunn@formerly-netscape.com.tld","author":"pnunn@formerly-netscape.com.tld","time":"Fri Apr 28 17:53:24 EEST 2000","text":"Eli: Would you check this again. Chances are Greg was misinterpreting another class of error. Closing as fixed to put on your radar. -P","id":277817,"bug_id":924,"tags":[]},{"is_private":false,"creation_time":"Tue May 02 23:11:48 EEST 2000","creator":"elig@formerly-netscape.com.tld","author":"elig@formerly-netscape.com.tld","time":"Tue May 02 23:11:48 EEST 2000","text":"The http://www.cdrom.com/pub/png/pngsuite.html page displays on today's Win/Mac/ Linux builds with no crash. Verifying. ","id":281151,"bug_id":924,"tags":[]}]}
